(("undefined"!=typeof self?self:this).webpackJsonp=("undefined"!=typeof self?self:this).webpackJsonp||[]).push([[60],{1008:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var o=n(0),r=n(8),a=n.n(r);n(1088);function i(){return(i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var s=function(t){var e,n;function r(e){var n;return(n=t.call(this,e)||this).onClick=n.onClick.bind(c(c(n))),n.state={checked:!!e.checked},n}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var a=r.prototype;return a.UNSAFE_componentWillReceiveProps=function(t){var e=t.checked;e!==this.props.checked&&e!==this.state.checked&&this.setState({checked:e})},a.onClick=function(t){t.preventDefault();var e=!this.state.checked;this.props.invalid||this.setState({checked:e});var n=this.props.onClick;"function"==typeof n&&n(e,t)},a.render=function(){return o.createElement(u,i({},this.props,{checked:this.state.checked,onClick:this.onClick}))},r}(o.Component);function l(){}function u(t){var e,n=t.checked,r=t.disabled,i=t.invalid,c=t.label,s=t.onClick,u=t.classnames,p=t.className,d=t.style;return o.createElement("label",{className:a()("stardust-checkbox",u,p,(e={},e["stardust-checkbox--disabled"]=r||i,e["stardust-checkbox--checked"]=n,e)),onClick:!r&&s?s:l,style:d},o.createElement("input",{className:"stardust-checkbox__input",type:"checkbox",onClick:l}),o.createElement("div",{className:"stardust-checkbox__box"}),c)}},1088:function(t,e,n){},1345:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var o=n(0),r=n.n(o),a=(n(1557),n(8)),i=n.n(a);function c(){return(c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}function s(t){var e=t.controlled,n=void 0===e||e,o=t.className,a=t.type,s=void 0===a?"text":a,l=t.value,u=void 0===l?"":l,p=t.disabled,d=void 0!==p&&p,f=t.onChange,h=t.validateShowErrorMessage,m=void 0!==h&&h,v=t.errorMessage,b=t._ref,y=void 0===b?function(){}:b,_=function(t,e){if(null==t)return{};var n,o,r={},a=Object.keys(t);for(o=0;o<a.length;o++)n=a[o],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,["controlled","className","type","value","disabled","onChange","validateShowErrorMessage","errorMessage","_ref"]);return r.a.createElement("div",{className:"stardust-input"},r.a.createElement("input",c({className:i()("stardust-input__element",{"stardust-input__element--invalid":m||!!v,"stardust-input__element--disabled":d},o),disabled:d,type:s,onChange:d?function(){}:f,ref:y},n?{value:u}:null,_)),v?r.a.createElement("div",{className:"stardust-input__invalid-message"},v):null)}},1514:function(t,e,n){"use strict";n.r(e);var o=n(0),r=n.n(o),a=n(52),i=n(159),c=n(419);function s(t){return t[1]===i.a.DOMESTIC||t[1]===i.a.OVERSEAS?t[1]:t[0]}function l(t,e){return!!e&&e.includes(s(t))}function u(t,e,n,o){void 0===n&&(n=Date.now());var r=o.selectedLocations,a=o.originalIndex;return function(t,e,n){return t*((Array.isArray(n)?n.indexOf(e):-1)+1)}(n,t,r)+(e[t]||0)||-(a||0)}function p(t,e,n){var o=Date.now(),r=function(t){return u(t,e,o,{selectedLocations:n})};return Object.keys(e).sort(function(t,e){return r(e)-r(t)})}function d(t,e,n){var o=Date.now(),r=function(r){return u(r[0],e,o,{selectedLocations:n,originalIndex:t.indexOf(r)})};return[].concat(t).sort(function(t,e){return r(e)-r(t)})}var f=n(1047),h=n(46),m=n(57),v=n(1110),b=n(1080),y=n(1140),_=n(2515),C=n.n(_),g=function(t){var e=t.onClick,n=t.innerRef;return r.a.createElement("div",{className:C.a.button,onClick:e,ref:n},Object(h.b)("label_other_locations")," >")},k=n(1345),L=n(1245),O=n(302),E=n(2516),x=n.n(E);var S=function(t){var e,n;function o(){return t.apply(this,arguments)||this}return n=t,(e=o).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,o.prototype.render=function(){var t=this.props,e=t.input,n=t.onInputChange,o=t.onInputClear;return r.a.createElement("div",{className:x.a.header},r.a.createElement("div",{className:x.a.title},Object(h.b)("label_location")),r.a.createElement("div",{className:x.a.inputContainer},r.a.createElement(k.a,{className:x.a.textBox,value:e,onChange:n,placeholder:Object(h.b)("label_search_locations_placeholder")}),!e&&r.a.createElement(L.a,{className:x.a.searchIcon}),!!e&&r.a.createElement("div",{className:x.a.clearButton,onClick:function(t){t.stopPropagation(),o()}},r.a.createElement(O.a,{className:x.a.crossIcon}))))},o}(r.a.PureComponent),N=n(8),j=n.n(N),R=(n(2517),function(t){var e=t.letters,n=t.activeLetter,o=t.onLetterClick,a=e.indexOf(n);return a=-1===a?0:a,r.a.createElement("div",{className:"stardust-alphabet-scroll-bar"},e.map(function(t,e){return r.a.createElement("span",{id:"scroll-"+t,key:e+"-"+t,className:j()("stardust-alphabet-scroll-bar__letter",{"stardust-alphabet-scroll-bar__letter--active":a===e}),onClick:o(t)},t)}))}),B=n(413);n(2518);var I=30,P=10,w=function(t){var e,n;function r(e){var n;(n=t.call(this,e)||this)._childrenRefs={},n.isUnmounted=!1,n.handleScroll=function(){for(var t=void 0!==n.props.intersectionOffset?n.props.intersectionOffset:P,e=n._ref.getBoundingClientRect(),o=Object.keys(n._childrenRefs),r=0,a=!1;r<o.length&&!a;){var i=n._childrenRefs[o[r]].getBoundingClientRect(),c=e.top,s=i.top-t,l=i.bottom-t;c>=s&&c<l&&(a=!0,n.setActiveLetter(o[r])),r+=1}},n.handleScrollBarClick=function(t){return function(){var e=n._childrenRefs[t].getBoundingClientRect(),o=n._ref.getBoundingClientRect(),r=e.top,a=o.top;n._ref.scrollBy(0,r-a),n.setActiveLetter(t)}},n.getRef=function(t){t&&(n._ref=t)},n.getChildrenRef=function(t){return function(e){e&&(n._childrenRefs[t]=e)}},n.state={activeLetter:""};var o=e.throttleThreshold||I;return n.throttleScrollHandler=Object(B.a)(n.handleScroll,o),n}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var a=r.prototype;return a.componentDidMount=function(){this._ref&&this._ref.addEventListener("scroll",this.throttleScrollHandler,!0)},a.componentWillUnmount=function(){this.isUnmounted=!0,this._ref&&this._ref.removeEventListener("scroll",this.throttleScrollHandler,!0)},a.setActiveLetter=function(t){this.state.activeLetter===t||this.isUnmounted||this.setState({activeLetter:t})},a.render=function(){var t=this,e=this.props,n=e.sections,r=e.indexes,a=e.className,i=e.maxHeight;return o.createElement("div",{className:j()("stardust-alphabet-scroll",a||"")},o.createElement("div",{className:"stardust-alphabet-scroll__list",ref:this.getRef,style:{maxHeight:i}},n.map(function(e,n){return o.createElement("div",{key:e.key+"-"+n,ref:t.getChildrenRef(e.key)},e.element)})),o.createElement(R,{letters:r,activeLetter:this.state.activeLetter,onLetterClick:this.handleScrollBarClick}))},r}(o.Component),D=n(1008),A=n(2519),F=n.n(A);var H=function(t){var e,n;function o(){return t.apply(this,arguments)||this}n=t,(e=o).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var a=o.prototype;return a.shouldComponentUpdate=function(t){return JSON.stringify(t.group)!==JSON.stringify(this.props.group)||JSON.stringify(t.selectedLocations)!==JSON.stringify(this.props.selectedLocations)},a.render=function(){var t=this.props,e=t.group,n=t.selectedLocations,o=t.onCheckboxClick,a=e.locations.filter(function(t){return t});return a.length>0?r.a.createElement("div",null,""!==e.group&&r.a.createElement("div",{className:F.a.groupTitle},e.group),r.a.createElement("div",{className:F.a.locationGroup},a.map(function(t,e){var a,i=n.includes(t),c=!i&&n.length>=f.b;return r.a.createElement("div",{key:e+"-"+t,className:F.a.option,title:t},r.a.createElement(D.a,{classnames:j()(F.a.checkbox,(a={},a[F.a.checkboxDisabled]=c,a)),label:r.a.createElement("span",{className:F.a.label},t),onClick:o.bind(null,t),checked:i,disabled:c}))}))):null},o}(r.a.Component),T=n(418),U=n(986),J=n.n(U),M=n(2520),G=n.n(M);var K=function(t){var e,n;function o(){for(var e,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))||this).getHistoryLocations=function(){var t=e.props.history;return{group:Object(h.b)("label_history"),locations:Object.keys(t).sort(function(e,n){return t[n]-t[e]}).slice(0,f.c)}},e.getLocationGroups=function(){var t=e.props,n=t.cityGroupList,o=t.filterKeyword,r=[e.getHistoryLocations()].concat(n);return o?r.map(function(t){return{group:t.group,locations:t.locations.filter(function(t){var e=(Object(T.b)(t)||"").toLowerCase(),n=(Object(T.b)(o)||"").toLowerCase();return-1!==e.indexOf(n)})}}).filter(function(t){return t.locations.length>0}):r},e}return n=t,(e=o).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,o.prototype.render=function(){var t=this.props,e=t.cityGroupList,n=t.selectedLocations,o=t.onCheckboxClick,a=e.map(function(t){return t.group}),i=this.getLocationGroups().map(function(t){return{key:t.group,element:r.a.createElement(H,{group:t,selectedLocations:n,onCheckboxClick:o})}});return 0===i.length?r.a.createElement("div",{className:G.a.body},r.a.createElement("div",{className:G.a.emptyState},r.a.createElement("img",{src:J.a,alt:"Not Found",className:G.a.emptyStateImage}),Object(h.b)("msg_search_location_not_found"))):r.a.createElement("div",{className:G.a.body},r.a.createElement(w,{indexes:a,sections:i,className:G.a.list,maxHeight:415,intersectionOffset:20}))},o}(r.a.Component),W=Object(a.c)(function(t){var e=t.locationFilter;return{history:e.history,cityGroupList:e.cityList,locationState:t.locationFilter}})(K),q=n(404),Z=n(2521),V=n.n(Z),z=function(t){var e,n,o=t.isButtonDisabled,a=t.onConfirm,i=t.onReset;return r.a.createElement("div",{className:V.a.footer},r.a.createElement(q.a,{className:j()(V.a.resetButton,(e={},e[V.a.resetButtonDisabled]=o,e)),onClick:i,disabled:o},Object(h.b)("label_reset")),r.a.createElement(q.a,{type:"primary",className:j()(V.a.confirmButton,(n={},n[V.a.confirmButtonDisabled]=o,n)),onClick:a,disabled:o},Object(h.b)("label_confirm")))},X=n(2522),Q=n.n(X),Y=function(t){var e=t.selectedLocations,n=t.filterKeyword,o=t.onInputChange,a=t.onInputClear,i=t.onCheckboxClick,c=t.onConfirm,s=t.onReset,l=e.length>=20;return r.a.createElement("div",{className:Q.a.popup},r.a.createElement(S,{input:n,onInputChange:o,onInputClear:a}),l&&r.a.createElement("div",{className:Q.a.notification},Object(h.b)("msg_max_locations_filter_checked")),r.a.createElement(W,{selectedLocations:e,filterKeyword:n.length>=3?n:"",onCheckboxClick:i}),r.a.createElement(z,{isButtonDisabled:0===e.length,onConfirm:c,onReset:s}))},$=n(845),tt=n(6),et=n(318),nt=n(2523),ot=n.n(nt);var rt=function(t){var e,n;function o(e){var n;return(n=t.call(this,e)||this).handleInputChange=function(t){var e=t.target.value;(e||""===e)&&n.setState({filterKeyword:e})},n.handleCheckboxClick=function(t,e){n.setState(function(n){return{selectedLocations:e?[].concat(n.selectedLocations,[t]):n.selectedLocations.filter(function(e){return e!==t})}})},n.handleConfirmClick=function(){var t=n.props,e=t.onConfirm,o=t.onClose;(0,t.addBatchToLocationFilterHistory)(n.state.selectedLocations),e(n.state.selectedLocations),o(),n.handleInputClear()},n.handleResetClick=function(){var t=n.props,e=t.onConfirm,o=t.onClose;n.setState({filterKeyword:"",selectedLocations:[]},function(){e(n.state.selectedLocations),o()})},n.handlePopupButtonClick=function(){var t=n.props,e=t.isActive,o=t.onOpen,r=t.onClose;e?r():n.setState({selectedLocations:Object(tt.a)(n.props,["searchParams","locations"],[])},o)},n.handleInputClear=function(){n.setState({filterKeyword:""})},n.getRef=function(t){t&&(n._ref=t)},n.getButtonRef=function(t){t&&(n._buttonRef=t)},n.state={filterKeyword:"",selectedLocations:Object(tt.a)(e,["searchParams","locations"],[])},n}n=t,(e=o).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var a=o.prototype;return a.componentDidMount=function(){this.props.getLocationFilterCityList()},a.render=function(){var t=this.props,e=t.isActive,n=t.searchParams,o=t.onClose;return r.a.createElement($.a,null,r.a.createElement("div",{className:ot.a.container,ref:this.getRef},r.a.createElement(y.b,{popover:r.a.createElement(Y,{searchParams:n,containerRef:this._ref,filterKeyword:this.state.filterKeyword,selectedLocations:this.state.selectedLocations,onInputChange:this.handleInputChange,onInputClear:this.handleInputClear,onCheckboxClick:this.handleCheckboxClick,onConfirm:this.handleConfirmClick,onReset:this.handleResetClick}),target:r.a.createElement(g,{onClick:this.handlePopupButtonClick,innerRef:this.getButtonRef}),open:e,position:y.a.BOTTOM_RIGHT,margin:-50,onClickOutside:o})))},o}(r.a.Component),at=Object(a.c)(null,{getLocationFilterCityList:et.f,addBatchToLocationFilterHistory:et.d})(rt);n(2524);function it(){return(it=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}var ct=function(t,e){var n=t.locations,o=t.searchParams,r=t.locationHistory;return n&&!e.isLocationSet?{isLocationSet:!0,displayLocations:function(t,e,n){for(var o=p(0,e,n),r=t.map(function(t){return t[0]}),a=[],i=0;a.length<f.c&&i<o.length;){var c=o[i];(!r.includes(c)||n&&n.includes(c))&&(a=[].concat(a,[c])),i++}var s=d(t,e,n).filter(function(t){return!a.includes(t[0])});return[].concat(a.map(function(t){return[t,""]}),s)}(n,r,o.locations||[]).slice(0,f.b)}:{}},st=function(t){var e,n;function o(e){var n;return(n=t.call(this,e)||this).handleOpenOtherLocation=function(){n.setState({isPopupActive:!0})},n.handleCloseOtherLocation=function(){n.setState({isPopupActive:!1})},n.handleConfirmLocations=function(t){var e=n.props.searchParams;n.props.onChangeSearchParams(it({},e,{locations:t.length>0?t.map(function(t){return encodeURIComponent(t)}):void 0})),n.setState({isLocationSet:!1},n.setDisplayLocations)},n.handleLocationClick=function(t,e){var o=n.props,r=o.searchParams,a=o.onChangeSearchParams,i=o.locations,s=(r.locations||[]).map(function(t){return encodeURIComponent(t)}),l=Object(c.d)(encodeURIComponent(t),s,f.b);if(e){var u=(i||[]).find(function(e){return e[1]===t});n.props.addToLocationFilterHistory(u?u[0]:t)}a({locations:l.length?l:void 0})},n.state={isPopupActive:!1,isLocationSet:!1,displayLocations:[]},n}n=t,(e=o).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var a=o.prototype;return a.componentDidMount=function(){this.setDisplayLocations()},o.getDerivedStateFromProps=function(t,e){return ct(t,e)},a.setDisplayLocations=function(){var t=ct(this.props,this.state);Object.keys(t).length&&this.setState(t)},a.render=function(){var t=this,e=this.props,n=e.locations,o=e.searchParams,a=e.collapseDisplayLimit,i=void 0===a?4:a,c=e.collapseStartOffset,u=void 0===c?6:c;if(!n||n.length<1)return null;var p=this.state,d=p.displayLocations,f=p.isPopupActive,y=o.locations||[],_=[];return m.a.FILTER_LOCATION_PHASE_2&&d.length>u&&_.push(r.a.createElement(at,{key:"others",searchParams:o,isActive:f,onOpen:this.handleOpenOtherLocation,onClose:this.handleCloseOtherLocation,onConfirm:this.handleConfirmLocations})),r.a.createElement(v.a,{className:"shopee-location-filter",header:Object(h.b)("label_shipped_from"),targetType:"LocationFilter",collapseDisplayLimit:i,collapseStartOffset:u,unfoldInitially:function(t){return d.slice(t).some(function(t){return l(t,y)})},filters:d.map(function(e){var n=s(e),o=e[0],a=l(e,y);return r.a.createElement(b.a,{key:n,value:n,label:o,isChecked:a,targetType:"LocationFilterItem",onCheck:t.handleLocationClick})}).concat(_)})},o}(r.a.Component);e.default=Object(a.c)(function(t){return{locationHistory:t.locationFilter?t.locationFilter.history:[]}},{addToLocationFilterHistory:et.e})(st)},1557:function(t,e,n){},2515:function(t,e,n){t.exports={button:"_2vZXoe"}},2516:function(t,e,n){t.exports={header:"xNaJ7p",title:"_2LuT0l",inputContainer:"keq_sn",searchIcon:"_2BME_c",crossIcon:"fhdxZ4",clearButton:"_3o-r4P",textBox:"_2HLps-"}},2517:function(t,e,n){},2518:function(t,e,n){},2519:function(t,e,n){t.exports={groupTitle:"_3jFCb6",locationGroup:"_24SrZD",option:"_2AkdcP",label:"_278g8a",checkbox:"P10uIj",checkboxDisabled:"_3A7su4"}},2520:function(t,e,n){t.exports={body:"_1vj2BB",list:"_2vvVFO",emptyState:"_1q8wN5",emptyStateImage:"_3BuOvS"}},2521:function(t,e,n){t.exports={footer:"brJaBU",confirmButton:"_1D_UoH",resetButton:"_3scIzk",confirmButtonDisabled:"_2Wkxh2",resetButtonDisabled:"_3Jltwd"}},2522:function(t,e,n){t.exports={popup:"_2qWJx2",notification:"_33dLj6"}},2523:function(t,e,n){t.exports={container:"_1SGvSP"}},2524:function(t,e,n){},986:function(t,e,n){t.exports=n.p+"62d2399b89039bd1dc90ca2d50d3e802.png"}}]);
//# sourceMappingURL=https://shopee.sg/assets/LocationFilter.5e125e6c3e7c45134996.js.map